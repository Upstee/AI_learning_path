# CNN常见问题FAQ

> **目的**：快速解决学习过程中的常见问题

---

## 概念理解问题

### Q1: 卷积和全连接有什么区别？

**A**: 

| 特性 | 卷积层 | 全连接层 |
|------|--------|---------|
| **连接方式** | 局部连接 | 全局连接 |
| **参数共享** | ✅ 是 | ❌ 否 |
| **参数数量** | 少 | 多 |
| **适用场景** | 图像、序列 | 最终分类 |

**示例**：
```python
# 卷积层：局部连接，参数共享
conv = nn.Conv2d(1, 16, kernel_size=3)  # 参数少

# 全连接层：全局连接，参数独立
fc = nn.Linear(784, 128)  # 参数多
```

---

### Q2: 为什么CNN适合图像处理？

**A**: 

**CNN利用了图像的三个特性**：

1. **局部性**：图像的特征是局部的（边缘、纹理）
2. **平移不变性**：特征在图像中的位置不重要
3. **层次性**：从简单特征（边缘）到复杂特征（物体）

**对比**：
- 全连接网络：忽略图像的局部结构
- CNN：利用局部结构，更高效

---

### Q3: 如何选择卷积核大小？

**A**: 

**常见选择**：
- **3x3**：最常用，效果好
- **5x5**：可以替代两个3x3
- **7x7**：早期使用，现在较少
- **1x1**：用于降维和增加非线性

**建议**：
- 默认使用3x3
- 需要更大感受野时，使用多个3x3卷积

---

### Q4: 池化的作用是什么？

**A**: 

**作用**：
1. **降维**：减少特征图大小
2. **平移不变性**：对小的平移不敏感
3. **减少参数**：减少后续层的参数

**类型**：
- **最大池化**：保留最显著特征
- **平均池化**：保留平均特征

---

## 代码实现问题

### Q5: 如何计算卷积后的尺寸？

**A**: 

**公式**：
```
输出尺寸 = (输入尺寸 - 卷积核大小 + 2*填充) / 步长 + 1
```

**示例**：
```python
# 输入：28x28
# 卷积：3x3，padding=1，stride=1
# 输出：(28 - 3 + 2*1) / 1 + 1 = 28

# 池化：2x2，stride=2
# 输出：28 / 2 = 14
```

---

### Q6: 如何可视化CNN的特征图？

**A**: 

```python
# 注册hook获取中间层输出
activations = {}

def hook_fn(name):
    def hook(module, input, output):
        activations[name] = output.detach()
    return hook

# 注册
model.conv1.register_forward_hook(hook_fn('conv1'))

# 前向传播
model.eval()
with torch.no_grad():
    _ = model(input_image)

# 可视化
conv1_output = activations['conv1']
# 可视化特征图...
```

---

## 实际应用问题

### Q7: CNN在哪些场景中应用？

**A**: 

**常见应用**：
1. **图像分类**：识别图像中的物体
2. **目标检测**：检测和定位物体
3. **图像分割**：像素级分类
4. **人脸识别**：识别和验证人脸

更多场景请参考相关资源。

---

## 错误排查

### Q8: 维度不匹配错误

**A**: 

**原因**：输入尺寸和模型期望不匹配

**解决**：
```python
# 检查输入尺寸
print(f"输入尺寸: {input.shape}")

# 使用Reshape或View调整
x = x.view(-1, 1, 28, 28)  # 调整到正确尺寸
```

---

## 📖 更多资源

- **快速上手**：[00_快速上手.md](./00_快速上手.md)
- **学习检查点**：[学习检查点.md](./学习检查点.md)
- **可视化工具**：[../01_神经网络基础/神经网络可视化工具.md](../01_神经网络基础/神经网络可视化工具.md)
- **训练监控**：[../01_神经网络基础/训练过程监控指南.md](../01_神经网络基础/训练过程监控指南.md)

---

**如果这里没有你遇到的问题，请查看其他资源！** 💪
