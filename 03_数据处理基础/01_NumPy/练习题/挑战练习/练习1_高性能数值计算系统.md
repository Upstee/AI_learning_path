# 挑战练习1：高性能数值计算系统

## 练习目标

构建一个高性能的数值计算系统，优化NumPy代码性能。

## 练习要求

### 1. 性能优化（30分）

给定一个计算任务（如计算大量数据的统计量），完成：

1. **基准实现**：
   - 使用Python循环实现
   - 测量执行时间

2. **NumPy向量化**：
   - 使用NumPy向量化操作重写
   - 测量性能提升

3. **内存优化**：
   - 使用适当的数据类型
   - 避免不必要的数组复制
   - 使用视图而非副本

4. **性能分析**：
   - 使用`%timeit`或`time`模块测量性能
   - 分析性能瓶颈
   - 提出优化建议

### 2. 大规模数据处理（30分）

1. **内存高效处理**：
   - 处理无法一次性加载到内存的大数组
   - 使用分块处理（chunk processing）
   - 实现流式处理

2. **并行计算**（可选）：
   - 使用`multiprocessing`并行处理
   - 比较串行和并行性能

### 3. 自定义向量化函数（20分）

1. **使用np.vectorize**：
   - 将Python函数向量化
   - 注意性能限制

2. **使用NumPy的ufunc**：
   - 创建自定义的ufunc（如果可能）
   - 或使用现有的ufunc组合

### 4. 数值稳定性（20分）

1. **避免数值误差**：
   - 处理大数相减导致的精度损失
   - 使用稳定的数值算法

2. **数据类型选择**：
   - 根据精度要求选择数据类型
   - 平衡精度和性能

## 代码要求

- 完整的性能优化系统
- 详细的性能分析报告
- 代码模块化，可复用
- 包含基准测试

## 评估标准

- **性能优化**（40分）：有明显的性能提升
- **代码质量**（30分）：代码清晰，模块化
- **分析深度**（30分）：性能分析深入

## 提示

- 使用`np.memmap`处理大文件
- 使用`np.einsum`进行复杂运算
- 避免Python循环
- 使用适当的数据类型
- 考虑使用Numba或Cython进一步优化

---

**完成后，请将代码保存为 `练习1_答案.py`，并放在 `答案/` 文件夹中。**

