# 进阶练习2：多分类与类别不平衡处理

## 练习目标

学习如何处理多分类问题和类别不平衡问题。

## 练习要求

### 1. 多分类问题

使用多分类数据集（如Iris、Wine、Digits），完成：

1. **数据准备**
   - 加载多分类数据集
   - 探索类别分布
   - 划分训练集和测试集

2. **模型训练**
   - 使用`multi_class='multinomial'`进行多分类
   - 使用`multi_class='ovr'`（One-vs-Rest）对比
   - 比较两种方法的性能

3. **模型评估**
   - 计算每个类别的精确率、召回率、F1分数
   - 绘制混淆矩阵
   - 分析每个类别的分类效果
   - 识别容易混淆的类别对

4. **可视化**
   - 使用PCA或t-SNE降维可视化
   - 可视化决策边界（如果是2D特征）
   - 绘制每个类别的概率分布

### 2. 类别不平衡问题

使用不平衡数据集（如信用卡欺诈检测、异常检测），完成：

1. **问题识别**
   - 分析类别分布
   - 计算类别不平衡比例
   - 评估不平衡对模型的影响

2. **处理方法1：过采样（SMOTE）**
   - 使用SMOTE生成少数类样本
   - 训练模型
   - 评估性能

3. **处理方法2：欠采样**
   - 使用随机欠采样
   - 训练模型
   - 评估性能

4. **处理方法3：类别权重**
   - 使用`class_weight='balanced'`
   - 训练模型
   - 评估性能

5. **处理方法4：阈值调整**
   - 使用ROC曲线选择最优阈值
   - 调整决策阈值
   - 评估不同阈值的效果

6. **方法对比**
   - 比较不同方法的准确率、精确率、召回率、F1分数
   - 绘制ROC曲线对比
   - 绘制PR曲线对比
   - 分析各方法的优缺点

### 3. 综合应用

结合多分类和类别不平衡，完成：

1. **多分类不平衡问题**
   - 选择一个多分类不平衡数据集
   - 应用合适的处理方法
   - 评估效果

2. **结果分析**
   - 分析不同类别的不平衡程度
   - 分析处理后的效果
   - 提出改进建议

## 代码要求

- 实现所有处理方法
- 使用交叉验证评估
- 详细的对比分析
- 清晰的可视化

## 评估标准

- **正确性**（30分）：正确实现所有方法
- **完整性**（25分）：包含所有要求的功能
- **分析深度**（25分）：深入分析结果
- **可视化**（20分）：图表清晰美观

## 预期结果

- 理解多分类的不同策略
- 掌握类别不平衡的处理方法
- 能够选择合适的方法
- 清晰的对比分析

## 提示

1. **SMOTE使用**：
   ```python
   from imblearn.over_sampling import SMOTE
   smote = SMOTE(random_state=42)
   X_resampled, y_resampled = smote.fit_resample(X, y)
   ```

2. **类别权重**：
   ```python
   model = LogisticRegression(class_weight='balanced')
   # 或自定义权重
   model = LogisticRegression(class_weight={0: 1, 1: 10})
   ```

3. **阈值调整**：
   ```python
   from sklearn.metrics import roc_curve
   fpr, tpr, thresholds = roc_curve(y_test, y_proba)
   optimal_idx = np.argmax(tpr - fpr)
   optimal_threshold = thresholds[optimal_idx]
   ```

4. **PR曲线**：
   ```python
   from sklearn.metrics import precision_recall_curve
   precision, recall, thresholds = precision_recall_curve(y_test, y_proba)
   ```

---

**完成后，请将代码保存为 `练习2_答案.py`，并放在 `答案/` 文件夹中。**

