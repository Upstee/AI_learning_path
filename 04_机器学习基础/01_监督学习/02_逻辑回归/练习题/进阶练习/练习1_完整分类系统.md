# 进阶练习1：完整分类系统

## 练习目标

构建一个完整的分类系统，包括数据预处理、特征工程、模型训练、评估和优化。

## 练习要求

### 1. 数据加载与探索

1. **加载真实数据集**
   - 使用真实数据集（如Titanic、Adult Income等）
   - 或使用`sklearn.datasets.fetch_openml`加载公开数据集

2. **数据探索（EDA）**
   - 查看数据基本信息（形状、类型、缺失值）
   - 计算描述性统计
   - 可视化数据分布
   - 分析类别分布（是否平衡）

### 2. 数据预处理

1. **缺失值处理**
   - 识别缺失值
   - 选择处理策略（删除、填充、插值）
   - 实现缺失值处理

2. **特征编码**
   - 处理类别特征（One-Hot编码、标签编码）
   - 处理数值特征（标准化、归一化）

3. **特征选择**
   - 使用相关性分析
   - 使用统计检验（卡方检验、F检验）
   - 选择重要特征

### 3. 特征工程

1. **创建新特征**
   - 特征组合（如年龄×收入）
   - 特征变换（如对数变换）
   - 多项式特征（可选）

2. **特征缩放**
   - 标准化或归一化
   - 确保特征在同一量级

### 4. 模型训练与优化

1. **基础模型**
   - 使用逻辑回归训练基础模型
   - 评估初始性能

2. **超参数调优**
   - 使用网格搜索或随机搜索
   - 优化正则化参数C
   - 优化正则化类型（L1/L2）

3. **交叉验证**
   - 使用K折交叉验证评估模型
   - 分析不同折的性能差异

### 5. 模型评估

1. **性能指标**
   - 准确率、精确率、召回率、F1分数
   - ROC曲线和AUC
   - 混淆矩阵

2. **可视化**
   - 绘制ROC曲线
   - 绘制混淆矩阵热力图
   - 绘制特征重要性（如果有）

3. **结果分析**
   - 分析模型在哪些类别上表现好/差
   - 分析误分类的原因
   - 提出改进建议

### 6. 模型解释

1. **特征重要性**
   - 分析模型系数
   - 识别最重要的特征
   - 解释特征对预测的影响

2. **决策边界分析**
   - 可视化决策边界（如果是2D特征）
   - 分析决策规则

## 代码要求

- 完整的端到端流程
- 模块化设计（函数/类）
- 详细的注释和文档
- 错误处理
- 结果可视化

## 评估标准

- **完整性**（30分）：包含所有步骤
- **代码质量**（25分）：代码结构清晰，模块化
- **模型性能**（25分）：模型性能良好
- **分析深度**（20分）：结果分析深入

## 预期结果

- 完整的分类系统
- 模型性能良好（准确率 > 0.75，取决于数据集）
- 清晰的可视化和分析
- 可复用的代码结构

## 提示

1. **使用Pipeline**：
   ```python
   from sklearn.pipeline import Pipeline
   pipeline = Pipeline([
       ('scaler', StandardScaler()),
       ('classifier', LogisticRegression())
   ])
   ```

2. **处理类别不平衡**：
   ```python
   from imblearn.over_sampling import SMOTE
   smote = SMOTE()
   X_resampled, y_resampled = smote.fit_resample(X, y)
   ```

3. **特征重要性**：
   ```python
   feature_importance = pd.DataFrame({
       'feature': feature_names,
       'coefficient': model.coef_[0],
       'abs_coefficient': np.abs(model.coef_[0])
   }).sort_values('abs_coefficient', ascending=False)
   ```

---

**完成后，请将代码保存为 `练习1_答案.py`，并放在 `答案/` 文件夹中。**

