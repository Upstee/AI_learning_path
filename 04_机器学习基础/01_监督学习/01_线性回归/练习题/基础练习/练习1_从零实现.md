# 基础练习1：从零实现线性回归

## 练习目标

不使用任何机器学习库（如scikit-learn），从零实现线性回归算法，包括：
1. 梯度下降优化
2. 预测功能
3. 评估指标计算

## 练习要求

### 1. 实现LinearRegression类

创建一个`LinearRegression`类，包含以下方法：

- `__init__(self, learning_rate=0.01, max_iter=1000, tol=1e-6)`
  - 初始化学习率、最大迭代次数、收敛容差
  
- `fit(self, X, y)`
  - 训练模型，使用梯度下降优化参数
  - X是特征矩阵（m×n），y是目标向量（m×1）
  
- `predict(self, X)`
  - 预测新数据的目标值
  
- `score(self, X, y)`
  - 计算R²分数

### 2. 核心算法

**梯度下降更新规则**：
- 计算预测值：$h = Xw + b$
- 计算损失：$J = \frac{1}{2m}\sum(h - y)^2$
- 计算梯度：
  - $\frac{\partial J}{\partial w} = \frac{1}{m}X^T(h - y)$
  - $\frac{\partial J}{\partial b} = \frac{1}{m}\sum(h - y)$
- 更新参数：
  - $w := w - \alpha \frac{\partial J}{\partial w}$
  - $b := b - \alpha \frac{\partial J}{\partial b}$

### 3. 测试代码

使用以下代码测试你的实现：

```python
import numpy as np

# 生成测试数据
np.random.seed(42)
X = np.random.randn(100, 1) * 10
y = 2 * X.flatten() + 1 + np.random.randn(100) * 2

# 创建模型并训练
model = LinearRegression(learning_rate=0.01, max_iter=1000)
model.fit(X, y)

# 预测
y_pred = model.predict(X)

# 评估
r2 = model.score(X, y)
print(f"R²分数: {r2:.4f}")
print(f"学习到的参数: w={model.w[0]:.4f}, b={model.b:.4f}")
print(f"真实参数: w=2.0, b=1.0")
```

### 4. 预期结果

- R²分数应该 > 0.9
- 学习到的参数应该接近真实参数（w≈2.0, b≈1.0）
- 损失函数应该收敛

## 提示

1. **初始化参数**：权重w初始化为小的随机值，偏置b初始化为0
2. **特征缩放**：如果特征量纲差异大，考虑标准化
3. **学习率**：从0.01开始，如果收敛慢可以增大，如果震荡可以减小
4. **收敛判断**：可以检查损失变化或迭代次数

## 扩展练习（可选）

1. 添加损失函数历史记录，绘制收敛曲线
2. 实现批量梯度下降、随机梯度下降、小批量梯度下降
3. 添加早停（early stopping）机制
4. 实现最小二乘法（解析解）作为对比

---

**完成后，请查看答案文件进行对比！**

