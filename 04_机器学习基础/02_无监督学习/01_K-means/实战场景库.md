# K-means实战场景库

> **目的**：提供真实业务场景的应用案例，帮助理解K-means的实际应用

---

## 📚 目录

- [常见应用场景](#常见应用场景)
- [真实项目案例](#真实项目案例)
- [算法对比表](#算法对比表)
- [面试常见问题](#面试常见问题)

---

## 常见应用场景

### 场景1：客户分群（Customer Segmentation）

**业务背景**：
- 电商平台需要根据客户行为将客户分成不同群体
- 用于精准营销、个性化推荐

**数据特征**：
- 消费金额（RFM模型中的M）
- 消费频率（RFM模型中的F）
- 最近消费时间（RFM模型中的R）
- 浏览行为、购买偏好等

**实现步骤**：
```python
# 1. 数据准备
features = ['total_spent', 'frequency', 'recency', 'avg_order_value']
X = df[features]

# 2. 标准化
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# 3. K值选择
# 使用轮廓系数选择最佳K值（通常3-5个群体）

# 4. 聚类
kmeans = KMeans(n_clusters=4, random_state=42)
df['customer_segment'] = kmeans.fit_predict(X_scaled)

# 5. 分析每个群体的特征
for i in range(4):
    segment = df[df['customer_segment'] == i]
    print(f"群体{i}: 高价值客户/活跃客户/沉睡客户/新客户")
```

**应用价值**：
- 高价值客户：VIP服务、专属优惠
- 活跃客户：定期推送、会员活动
- 沉睡客户：唤醒活动、优惠券
- 新客户：新手引导、首单优惠

---

### 场景2：图像分割与压缩

**业务背景**：
- 图像压缩：用K种颜色代表所有颜色
- 图像分割：将图像分成K个区域

**数据特征**：
- 每个像素的RGB值（3维特征）
- 可以扩展到位置信息（5维：R, G, B, x, y）

**实现步骤**：
```python
from PIL import Image
import numpy as np

# 1. 加载图像
img = Image.open('image.jpg')
img_array = np.array(img)
h, w, c = img_array.shape

# 2. 重塑为2D数组（每个像素是一个数据点）
pixels = img_array.reshape(-1, c)

# 3. K-means聚类（K=16，用16种颜色代表所有颜色）
kmeans = KMeans(n_clusters=16, random_state=42)
labels = kmeans.fit_predict(pixels)

# 4. 用质心颜色替换原像素
compressed_pixels = kmeans.cluster_centers_[labels]
compressed_img = compressed_pixels.reshape(h, w, c).astype(np.uint8)

# 5. 保存压缩后的图像
Image.fromarray(compressed_img).save('compressed_image.jpg')
```

**应用价值**：
- 图像压缩：减少存储空间
- 图像分割：提取主要区域
- 颜色量化：统一色调风格

---

### 场景3：文档主题聚类

**业务背景**：
- 新闻分类：将新闻文章分成K个主题
- 文档归档：自动整理文档

**数据特征**：
- 使用TF-IDF或词向量表示文档
- 特征维度：词汇表大小（通常几千到几万维）

**实现步骤**：
```python
from sklearn.feature_extraction.text import TfidfVectorizer

# 1. 文本向量化
vectorizer = TfidfVectorizer(max_features=1000)
X = vectorizer.fit_transform(documents)

# 2. 降维（可选，高维数据建议先降维）
from sklearn.decomposition import PCA
pca = PCA(n_components=50)
X_reduced = pca.fit_transform(X.toarray())

# 3. K-means聚类
kmeans = KMeans(n_clusters=5, random_state=42)
labels = kmeans.fit_predict(X_reduced)

# 4. 分析每个主题的关键词
for i in range(5):
    topic_docs = [documents[j] for j in range(len(documents)) if labels[j] == i]
    print(f"主题{i}: {len(topic_docs)}篇文章")
    # 提取关键词...
```

**应用价值**：
- 新闻分类：自动归类新闻
- 文档检索：快速找到相关文档
- 内容推荐：推荐同主题内容

---

### 场景4：异常检测

**业务背景**：
- 信用卡欺诈检测
- 网络入侵检测
- 设备故障检测

**数据特征**：
- 正常行为数据
- 异常行为数据（通常很少）

**实现步骤**：
```python
# 1. 使用K-means找到正常数据的簇
kmeans = KMeans(n_clusters=3, random_state=42)
kmeans.fit(normal_data)

# 2. 计算每个点到最近质心的距离
distances = kmeans.transform(all_data)
min_distances = distances.min(axis=1)

# 3. 设置阈值（距离大于阈值的为异常）
threshold = np.percentile(min_distances, 95)  # 前5%为异常
anomalies = all_data[min_distances > threshold]
```

**应用价值**：
- 欺诈检测：识别异常交易
- 故障预警：提前发现设备异常
- 安全监控：检测异常访问

---

### 场景5：市场细分

**业务背景**：
- 根据用户特征将市场分成K个细分市场
- 用于产品定位、营销策略

**数据特征**：
- 用户画像：年龄、收入、兴趣、行为等
- 多维度特征

**实现步骤**：
```python
# 1. 特征工程
features = ['age', 'income', 'education', 'interests', 'behavior_score']
X = df[features]

# 2. 标准化
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# 3. K-means聚类
kmeans = KMeans(n_clusters=4, random_state=42)
df['market_segment'] = kmeans.fit_predict(X_scaled)

# 4. 分析每个细分市场
for i in range(4):
    segment = df[df['market_segment'] == i]
    print(f"细分市场{i}:")
    print(f"  平均年龄: {segment['age'].mean():.1f}")
    print(f"  平均收入: {segment['income'].mean():.0f}")
    print(f"  主要兴趣: {segment['interests'].mode()[0]}")
```

**应用价值**：
- 产品定位：针对不同市场开发产品
- 营销策略：精准投放广告
- 定价策略：不同市场不同价格

---

## 真实项目案例

### 案例1：电商客户分群系统

**项目描述**：
为电商平台开发客户分群系统，将客户分成4个群体，用于精准营销。

**技术栈**：
- Python, scikit-learn, pandas
- 数据：10万客户，20个特征

**实现要点**：
1. 数据清洗：处理缺失值、异常值
2. 特征工程：RFM模型特征
3. K值选择：使用轮廓系数，选择K=4
4. 模型训练：K-means++初始化
5. 结果分析：分析每个群体的特征
6. 可视化：客户分群可视化

**项目成果**：
- 客户分成4个群体：VIP客户、活跃客户、普通客户、沉睡客户
- 营销转化率提升30%
- 客户满意度提升15%

**参考代码**：[实战案例/简单项目1_客户分群/](./实战案例/简单项目1_客户分群/)

---

### 案例2：图像压缩工具

**项目描述**：
开发图像压缩工具，使用K-means将图像压缩到16色，减少存储空间。

**技术栈**：
- Python, PIL, numpy, scikit-learn
- 数据：各种尺寸的图像

**实现要点**：
1. 图像预处理：转换为RGB数组
2. K-means聚类：K=16（16种颜色）
3. 颜色替换：用质心颜色替换原像素
4. 图像保存：保存压缩后的图像

**项目成果**：
- 图像大小减少80%
- 视觉质量保持良好
- 处理速度：1秒/张

**参考代码**：[实战案例/简单项目2_图像分割/](./实战案例/简单项目2_图像分割/)

---

### 案例3：新闻主题聚类系统

**项目描述**：
为新闻网站开发主题聚类系统，自动将新闻文章分成不同主题。

**技术栈**：
- Python, scikit-learn, jieba（中文分词）
- 数据：1万篇新闻文章

**实现要点**：
1. 文本预处理：分词、去停用词
2. 特征提取：TF-IDF向量化
3. 降维：PCA降维到50维
4. K-means聚类：K=10（10个主题）
5. 主题分析：提取每个主题的关键词

**项目成果**：
- 自动分类准确率85%
- 处理速度：1000篇/分钟
- 主题覆盖：政治、经济、科技、体育等

**参考代码**：[实战案例/中等项目1_文档聚类/](./实战案例/中等项目1_文档聚类/)

---

## 算法对比表

### 什么时候用K-means？

| 场景 | K-means | 其他算法 | 推荐 |
|------|---------|---------|------|
| **球形簇** | ✅ 适合 | DBSCAN、层次聚类 | K-means |
| **非球形簇** | ❌ 不适合 | DBSCAN | DBSCAN |
| **已知K值** | ✅ 适合 | 层次聚类 | K-means |
| **未知K值** | ⚠️ 需要选择 | 层次聚类、DBSCAN | 层次聚类 |
| **大数据** | ✅ 高效 | 层次聚类（慢） | K-means |
| **有噪声** | ❌ 敏感 | DBSCAN | DBSCAN |
| **簇大小相近** | ✅ 适合 | DBSCAN | K-means |
| **簇大小差异大** | ❌ 不适合 | DBSCAN | DBSCAN |

### 算法选择决策树

```
数据是否有明显的簇结构？
├── 是
│   ├── 簇是球形的？
│   │   ├── 是 → K-means ✅
│   │   └── 否 → DBSCAN
│   └── 不知道K值？
│       ├── 是 → 层次聚类
│       └── 否 → K-means ✅
└── 否
    └── 使用其他方法（可能需要特征工程）
```

---

## 面试常见问题

### Q1: 解释K-means算法的工作原理

**标准答案**：
1. 随机初始化K个质心
2. 将每个数据点分配到最近的质心
3. 重新计算每个簇的质心（均值）
4. 重复步骤2-3，直到质心不再变化或达到最大迭代次数

**加分点**：
- 提到目标函数（误差平方和）
- 提到收敛性保证
- 提到局部最优问题

---

### Q2: 如何选择K值？

**标准答案**：
1. **肘部法则**：绘制K-SSE曲线，找"肘部"点
2. **轮廓系数**：计算不同K值的轮廓系数，选择最大值
3. **业务需求**：根据实际业务需求确定K值

**加分点**：
- 提到两种方法结合使用
- 提到交叉验证不适用于无监督学习
- 提到K值选择的实际考虑

---

### Q3: K-means的优缺点是什么？

**优点**：
- 简单高效，计算快速
- 可扩展，适合大规模数据
- 广泛应用，易于理解

**缺点**：
- 需要预设K值
- 对初始值敏感
- 只能处理球形簇
- 对异常值敏感

**加分点**：
- 提到K-means++可以缓解初始值问题
- 提到Mini-batch K-means可以处理大数据
- 提到适用场景和局限性

---

### Q4: 如何优化K-means？

**优化方法**：
1. **K-means++初始化**：减少对初始值的敏感性
2. **Mini-batch K-means**：处理大规模数据
3. **数据标准化**：确保特征在相同尺度
4. **多次运行**：取最佳结果
5. **特征工程**：选择相关特征，降维

**加分点**：
- 提到具体实现方法
- 提到不同场景的优化策略
- 提到性能提升的量化指标

---

### Q5: K-means和层次聚类有什么区别？

**K-means**：
- 需要预设K值
- 计算快速，O(n)
- 适合大数据
- 结果不可逆

**层次聚类**：
- 不需要预设K值
- 计算慢，O(n²)或O(n³)
- 适合小数据
- 可以生成树状图

**加分点**：
- 提到适用场景
- 提到可以结合使用（先用层次聚类确定K值，再用K-means）

---

## 📖 更多资源

- **代码示例**：[代码示例/](./代码示例/)
- **实战案例**：[实战案例/](./实战案例/)
- **常见问题**：[常见问题FAQ.md](./常见问题FAQ.md)
- **学习检查点**：[学习检查点.md](./学习检查点.md)

---

**希望这些场景能帮助你更好地理解K-means的实际应用！** 🚀
